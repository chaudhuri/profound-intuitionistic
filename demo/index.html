<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <!-- START icons -->
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <!-- END icons -->
    <title>Profint Launcher</title>
    <!-- jquery -->
    <script src="vendor/jquery.min.js"></script>
    <!-- katex -->
    <link rel="stylesheet" href="vendor/katex.min.css">
    <script src="vendor/katex.min.js"></script>
    <!-- ace -->
    <script src="vendor/ace.js"></script>
    <script src="vendor/hotkeys.min.js"></script>
    <!-- profint -->
    <script src="ora.bc.js"></script>
    <script>
      const macros = {
          "\\o": "\\mathsf{o}",
          "\\i": "\\mathsf{i}",
      };

      const katex_options = {
          trust: true,
          output: 'html',
          strict: false,
          macros
      }

      const interfaceUrl = 'go.html';

      function complain(id) {
        $(id).css({ border: "2px solid red" });
        return false;
      }
      function acceptable(id) {
        $(id).css({ border: "none" });
        return true;
      }

      $(document).ready(function(){
          profint.signatureChange(document.sigEditor.getValue());
          $("#premade li").each(function(){
              const txt = $(this).text().trim();
              let anc =
                  $('<a>')
                  .attr('href', interfaceUrl + '?f=' + encodeURIComponent(txt))
                  .html(function(){
                      var expr = profint.convertToHTML(txt);
                      return katex.renderToString(expr, katex_options);
                  });
              $(this).empty().append(anc);
          });
      });
    </script>
    <style>
      body {padding-left: 40px; padding-top: 40px;}
      a {text-decoration: none;}
      /* #signature {margin: 0; position: fixed; left: 80%; top: 0; right: 0;} */
      #maincontent {
          display: flex; gap: 4vh;
          width: 100%;
          align-items: flex-start;
          margin: 0; padding: 0;
      }
      #maincontent > * {
          padding: 2vh 4vh;
          background-color: #eee;
      }
      #premade { flex-grow: 1; }
      #yourown { flex-grow: 2; }
    </style>
  </head>
  <body>
    <h1>Profound:Intuitionistic Launcher</h1>

    <!-- <h4 id="interfacelink" style="display:none">Default interface</h4> -->

    <div id="maincontent">
      <div id="yourown">
        <h2>State your conjecture:</h2>

        <h4>Signature</h4>
        <pre id="signature">
i : \type.
j : i.
f : i -> i.
p : i -> \o.</pre>
        <script>
          var sigEditor = ace.edit("signature");
          sigEditor.setTheme("ace/theme/twilight");
          sigEditor.setOptions({
            minLines: 5,
            maxLines: 20,
            showLineNumbers: false,
            showGutter: false,
          });
          document.sigEditor = sigEditor;
          sigEditor.on("change", function(e) {
            var res = profint.signatureChange(sigEditor.getValue());
            if (!res)
              $('#signature').css({'border': '2px solid red'});
            else
              $('#signature').css({'border': 'none'});
          });
        </script>

        <h4>To prove:</h4>

        <pre id="formula">(\A [x] p x => p (f x)) => p j => p (f (f j))</pre>
        <div style="margin:1vh auto;margin-left:2em;"><em>i.e.,</em></div>
        <div id="conjecture-output">
          ...
        </div>

        <script>
          var formEditor = ace.edit("formula");
          formEditor.setTheme("ace/theme/twilight");
          formEditor.setOptions({
            minLines: 3,
            maxLines: 5,
            showLineNumbers: false,
            showGutter: false,
          });
          document.formEditor = formEditor;
          function formEditorChange(e) {
            if (!profint.signatureChange(sigEditor.getValue()))
              return complain("#signature");
            let expr = "{\\color{red}\\text{ERROR}}";
            if (profint.formulaChange(formEditor.getValue())) {
              acceptable("#formula");
              expr = profint.formulaHTML();
            } else complain("#formula");
            $('#conjecture-output').html(function() {
              return katex.renderToString(expr, katex_options);
            });
          }
          formEditor.on("change", formEditorChange);
          formEditorChange();
        </script>

      </div>
      <div id="premade">
        <h2>â€¦ or try one of these:</h2>

        <h4>Propositional</h4>

        <ul>
          <li>a \to \top</li>
          <li>a \to a</li>
          <li>a \to b \to a</li>
          <li>a \to a \and a</li>
          <li>a \and b \to b \and a</li>
          <li>a \to b \to b \and a</li>
          <li>(a \to b \to c) \to (a \to b) \to a \to c</li>
        </ul>

        <h4>Classical theorems (and their double negations)</h4>

        <ul>
          <li>a \or (a \to \bot)</li>
          <li>((a \or (a \to \bot)) \to \bot) \to \bot</li>
          <li>((a \to b) \to a) \to a</li>
          <li>((((a \to b) \to a) \to a) \to \bot) \to \bot</li>
        </ul>

        <h4>Instantiation</h4>

        <ul>
          <li>\A [x, y] p (g x y) \to p (g x x)</li>
          <li>p j \to \E [x] p x</li>
          <li>(\A [x] p x) \to p k</li>
        </ul>

        <h4>Corner cases</h4>

        <ul>
          <li>(\A [x] \E [y] r x y) \to (\E [w] \A [z] r z w)</li>
          <li>(\E [w] \A [z] r z w) \to (\A [x] \E [y] r x y)</li>
          <li>(\A [x] p x) \to \E [y] p y</li>
          <li>(\A [x] p x) \to \A [y] p y</li>
        </ul>
      </div> <!-- premade -->
    </div> <!-- maincontent -->

<!--
    <script>
      var sigEditor = ace.edit("signature");
      sigEditor.setTheme("ace/theme/twilight");
      sigEditor.setOptions({
          minLines: 5,
          maxLines: 20,
          showLineNumbers: false,
          showGutter: false,
      });
      document.sigEditor = sigEditor;
      sigEditor.on("change", function(e) {
          var res = profint.signatureChange(sigEditor.getValue());
          if (!res)
              $('#signature').css({'border': '2px solid red'});
          else
              $('#signature').css({'border': 'none'});
      });
      // sigEditor.session.setMode("ace/mode/javascript");
    </script>
-->

  </body>
</html>
